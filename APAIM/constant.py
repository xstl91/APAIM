#!/usr/bin/env python
'''
Constants during calculations.
'''

import __main__

try:
    surface = __main__.surface
except AttributeError:
    surface = raw_input('Choose surface (100 or 111): ')
if surface not in ('100','111'):
    raise Exception('Unsupported surface.')

species_all = ('N','O','NO','CO')
#            ('N-N', 'N-O', 'N-NO', 'N-CO', 'O-O', 'O-NO', 'O-CO', 'NO-NO', 'NO-CO', 'CO-CO') 
species_pairs = tuple( x+'-'+y for num,x in enumerate(species_all) for y in species_all[num:] )
_route = '/'.join(__file__.split('/')[:-1])
single_E_file = _route + '/p_single/' + surface
inter_directory = _route + '/p_inter/' + surface

if surface == '100':
    recon_pair_hh1 = ('N-N','O-O','N-O')
    recon_pair_hh2 = ('O-O',)
    binding_types = sum(([x+'_top', x+'_brg', x+'_hol'] for x in species_all),[])
    inter_types = ('hh1','hh2','hh3',
                   'bb2h','bb2t','bb3','bb4h','bb4t','bb5h','bb5t','bb6',
                   'tt1','tt2','tt3',
                   'bh2','bh3','bh4','bh5',
                   'hb2','hb3','hb4','hb5',
                   'bt2','bt3','bt4','bt5',
                   'tb2','tb3','tb4','tb5',
                   'ht2','ht3',
                   'th2','th3')
    same_exclude = ('hb2','hb3','hb4','hb5',
                    'bb4t',
                    'tb2','tb3','tb4','tb5',
                    'th2','th3')

#                  'name':(example,distance/basis_vector)     
    inter_examp = {'hh1' :('22-24', 1.0  ), 'hh2' :('22-44', 1.414), 'hh3' :('22-26', 2.0  ),
                   'bb2h':('21-23', 1.0  ), 'bb2t':('21-41', 1.0  ), 'bb3' :('21-43', 1.414), 'bb4h':('21-34', 1.581),
                   'bb4t':('21-52', 1.581), 'bb5h':('21-25', 2.0  ), 'bb5t':('21-61', 2.0  ), 'bb6' :('21-54', 2.121),
                   'tt1' :('11-13', 1.0  ), 'tt2' :('11-33', 1.414), 'tt3' :('11-15', 2.0  ),
                   'bh2' :('21-42', 1.118), 'bh3' :('21-24', 1.5  ), 'bh4' :('21-44', 1.803), 'bh5' :('21-62', 2.062),
                   'hb2' :('22-34', 1.118), 'hb3' :('22-25', 1.5  ), 'hb4' :('22-45', 1.803), 'hb5' :('22-36', 2.062),
                   'bt2' :('21-33', 1.118), 'bt3' :('21-51', 1.5  ), 'bt4' :('21-53', 1.803), 'bt5' :('21-35', 2.062),
                   'tb2' :('11-23', 1.118), 'tb3' :('11-14', 1.5  ), 'tb4' :('11-34', 1.803), 'tb5' :('11-25', 2.062),
                   'ht2' :('22-35', 1.581), 'ht3' :('22-55', 2.121),
                   'th2' :('11-24', 1.581), 'th3' :('11-44', 2.121)}

    offset_abs_type = { 'block': { x:((1,1),(1,0),(0,1)) for x in ('b','h','t') },
                        'same1': { 'b':(),
                                   'h':((2,0),(0,2)),   # hh1
                                   't':((2,0),(0,2))},  # tt1
                        'same2': { 'b':((2,0),(0,2)),   # bb2
                                   'h':((2,2),),        # hh2
                                   't':((2,2),)},       # tt2
                        'same3': { 'b':((2,2),),        # bb3
                                   'h':((4,0),(0,4)),   # hh3
                                   't':((4,0),(0,4))},  # tt3
                        'same4': { 'b':((1,3),(3,1)),   # bb4
                                   'h':(),
                                   't':()},
                        'same5': { 'b':((4,0),(0,4)),   # bb5
                                   'h':(),
                                   't':()},
                        'same6': { 'b':((3,3),),         # bb6
                                   'h':(),
                                   't':()},
                        'dif2' : { 'b':((1,2),(2,1)),               # bh2 & bt2
                                   'h':((1,2),(2,1),(1,3),(3,1)),   # hb2 & ht2
                                   't':((1,2),(2,1),(1,3),(3,1))},  # tb2 & th2
                        'dif3' : { 'b':((0,3),(3,0)),               # bh3 & bt3
                                   'h':((0,3),(3,0),(3,3)),         # hb3 & ht3
                                   't':((0,3),(3,0),(3,3))},        # tb3 & th3
                        'dif4' : { x:((2,3),(3,2)) for x in ('b','h','t') },  # hb4 & tb4 & bt4 & bh4
                        'dif5' : { x:((1,4),(4,1)) for x in ('b','h','t') }}  # hb5 & tb5 & bt5 & bh5
    multiplicity = { 2 : ('hh3','bb5h','bb5t','tt3','bh5','hb5','bt5','tb5')}

    symmetry_site = {'11':('11','11'), '12':('18','21'), '13':('17','31'), '14':('16','41'),   # symmetry along 11-55 and 15-55
                     '15':('15','51'), '16':('14','61'), '17':('13','71'), '18':('12','81'),
                     '21':('21','12'), '22':('28','22'), '23':('27','32'), '24':('26','42'),
                     '25':('25','52'), '26':('24','62'), '27':('23','72'), '28':('22','82'),
                     '31':('31','13'), '32':('38','23'), '33':('37','33'), '34':('36','43'),
                     '35':('35','53'), '36':('34','63'), '37':('33','73'), '38':('32','83'),
                     '41':('41','14'), '42':('48','24'), '43':('47','34'), '44':('46','44'),
                     '45':('45','54'), '46':('44','64'), '47':('43','74'), '48':('42','84'),
                     '51':('51','15'), '52':('58','25'), '53':('57','35'), '54':('56','45'),
                     '55':('55','55'), '56':('54','65'), '57':('53','75'), '58':('52','85'),
                     '61':('61','16'), '62':('68','26'), '63':('67','36'), '64':('66','46'),
                     '65':('65','56'), '66':('64','66'), '67':('63','76'), '68':('62','86'),
                     '71':('71','17'), '72':('78','27'), '73':('77','37'), '74':('76','47'),
                     '75':('75','57'), '76':('74','67'), '77':('73','77'), '78':('72','87'),
                     '81':('81','18'), '82':('88','28'), '83':('87','38'), '84':('86','48'),
                     '85':('85','58'), '86':('84','68'), '87':('83','78'), '88':('82','88')}
    sym_operator = (0,1,0,1,0,1,0)
    trans_operator = ((0,2,4,6),(0,2,4,6))

elif surface == '111':
    binding_types = sum(([x+'_top', x+'_fcc', x+'_hcp'] for x in species_all),[])
    inter_types = ('ff1','ff2t','ff2h','ff3',
                   'hh1','hh2f','hh2t','hh3',
                   'tt1','tt2h','tt2f','tt3',
                   'fh2','fh3','fh4','fh5',
                   'hf2','hf3','hf4','hf5',
                   'ft2','ft3','ft4','ft5',
                   'tf2','tf3','tf4','tf5',
                   'ht2','ht3','ht4','ht5',
                   'th2','th3','th4','th5')
    same_exclude = ('hf2','hf3','hf4','hf5',
                    'tf2','tf3','tf4','tf5',
                    'th2','th3','th4','th5',
                    'ff2h','hh2t','tt2f')

#                  'name':(example,distance/basis_vector)
    inter_examp = {'ff1':('31-32', 1.0  ), 'ff2t':('31-63', 1.732), 'ff2h':('31-92', 1.732), 'ff3':('31-33', 2.0  ),
                   'hh1':('21-22', 1.0  ), 'hh2f':('21-53', 1.732), 'hh2t':('21-82', 1.732), 'hh3':('21-23', 2.0  ),
                   'tt1':('11-12', 1.0  ), 'tt2h':('11-43', 1.732), 'tt2f':('11-72', 1.732), 'tt3':('11-13', 2.0  ),
                   'fh2':('31-52', 1.155), 'fh3':('31-22', 1.528), 'fh4':('31-53', 2.082), 'fh5':('31-b2', 2.309),
                   'hf2':('21-62', 1.155), 'hf3':('21-33', 1.528), 'hf4':('21-92', 2.082), 'hf5':('21-64', 2.309),
                   'ft2':('31-12', 1.155), 'ft3':('31-43', 1.528), 'ft4':('31-13', 2.082), 'ft5':('31-74', 2.309),
                   'tf2':('11-32', 1.155), 'tf3':('11-62', 1.528), 'tf4':('11-33', 2.082), 'tf5':('11-92', 2.309),
                   'ht2':('21-43', 1.155), 'ht3':('21-73', 1.528), 'ht4':('21-44', 2.082), 'ht5':('21-a3', 2.309),
                   'th2':('11-51', 1.155), 'th3':('11-52', 1.528), 'th4':('11-82', 2.082), 'th5':('11-53', 2.309)}

    offset_type = { 'block': { 'f':((1,0),(2,0),(1,1),(-1,0),(-2,0),(-1,-1)),
                               'h':((1,0),(2,1),(1,1),(-1,1),(-2,0),(-1,0)),
                               't':((1,-1),(2,0),(1,0),(-1,0),(-2,-1),(-1,-1))},
                    'same1': { x:((0,-1),(0,1),(-3,-1),(-3,0),(3,0),(3,1)) for x in ('f','h','t') },  # ff1 & hh1 & tt1
                    'same2': { x:((3,-1),(3,2),(-3,1),(-3,2),(6,-1),(6,1)) for x in ('f','h','t') },  # ff2 & hh2 & tt2
                    'same3': { x:((0,2),(6,0),(6,2)) for x in ('f','h','t') },                        # ff3 & hh3 & tt3
                    'dif2' : { 'f':((2,-1),(4,1),(2,1),(-2,1),(-4,-1),(-2,-1)),   # fh2 & ft2 
                               'h':((2,0),(4,1),(2,2),(-2,1),(-4,0),(-2,-1)),     # hf2 & ht2
                               't':((2,-1),(4,0),(2,1),(-2,0),(-4,-1),(-2,2))},   # tf2 & th2
                    'dif3' : { 'f':((-1,2),(1,-1),(4,0),(5,0),(5,1),(4,2),(1,2),(-1,1),(-4,0),(-5,0),(-5,-1),(-4,2)),    # fh3 & ft3
                               'h':((-1,-1),(1,-1),(4,0),(5,1),(5,2),(4,2),(1,2),(-1,2),(-4,1),(-5,0),(-5,-1),(-4,-1)),  # hf3 & ht3
                               't':((-1,2),(1,2),(4,-1),(5,0),(5,1),(4,1),(1,1),(-1,1),(-4,0),(-5,-1),(-5,2),(-4,2))},   # tf3 & th3
                    'dif4' : { 'f':((5,-1),(-5,1),(-5,2),(5,2),(2,2),(-2,2)),   # fh4 & ft4
                               'h':((5,0),(-5,1),(-5,2),(5,-1),(2,-1),(-2,2)),  # hf4 & ht4
                               't':((5,-1),(-5,0),(-5,1),(5,2),(2,2),(-2,1))},  # tf4 & th4
                    'dif5' : { 'f':((-4,1),(4,-1)),    # fh5 & ft5
                               'h':((-4,2),(4,-1)),    # hf5 & ht5
                               't':((-4,1),(4,2))}}     # tf5 & th5
    offset_same2 = { x:{'f':'t', 'h':'f', 't':'h'} for x in ((3,-1),(3,2),(6,-1)) }        # ff2t & hh2f & tt2h
    offset_same2.update({ x:{'f':'h', 'h':'t', 't':'f'} for x in ((-3,1),(-3,2),(6,1)) })  # ff2h & hh2t & tt2f
    multiplicity = { 2 : ('hh3','tt3','ff3','fh4','ft4','hf4','ht4','tf4','th4'),
                     3 : ('fh5','ft5','hf5','ht5','tf5','th5')}

    symmetry_site = {'11':('11','13'), '12':('a1','12'), '13':('71','11'), '14':('41','14'),   # symmetry along 63-73 and 52-73
                     '21':('b4','22'), '22':('84','21'), '23':('54','24'), '24':('24','23'),
                     '31':('c4','33'), '32':('94','32'), '33':('64','31'), '34':('34','34'),
                     '41':('14','44'), '42':('a4','43'), '43':('74','42'), '44':('44','41'),
                     '51':('b3','53'), '52':('83','52'), '53':('53','51'), '54':('23','54'),
                     '61':('c3','64'), '62':('93','63'), '63':('63','62'), '64':('33','61'),
                     '71':('13','71'), '72':('a3','74'), '73':('73','73'), '74':('43','72'),
                     '81':('b2','84'), '82':('82','83'), '83':('52','82'), '84':('22','81'),
                     '91':('c2','91'), '92':('92','94'), '93':('62','93'), '94':('32','92'),
                     'a1':('12','a2'), 'a2':('a2','a1'), 'a3':('72','a4'), 'a4':('42','a3'),
                     'b1':('b1','b1'), 'b2':('81','b4'), 'b3':('51','b3'), 'b4':('21','b2'),
                     'c1':('c1','c2'), 'c2':('91','c1'), 'c3':('61','c4'), 'c4':('31','c3')}
    sym_operator = (0,1,0,1,0)
    trans_operator = ((0,3,6,9),(0,1,2,3))
